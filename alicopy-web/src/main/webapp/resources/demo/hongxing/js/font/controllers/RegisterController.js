(function(){var e,r;e=[],r=function(){var e;return e=function($rootScope,$scope,$http,$timeout,tele,pageUtils,storage,SERVER,ERROR_LOGIN_UNKNOWN,ERROR_LOGIN_TIME,LOGIN_EVENT_NAME){return $rootScope.name?($timeout(function(){return $scope.register.name.$stateVisible=!0}),$scope.password="",$scope.password2="",$scope.focuses={password:!0,password2:!1},$scope.validateConfirmedPassword=function(e){return $scope.password&&$scope.password2?e===$scope.password?!0:void 0:!0},$scope.doRegister=function(){var e,r,s,t,n,i;{if($scope.register.$valid)return $scope.disableInputs=!0,$http.get("https://"+SERVER+"/user/register",{params:{name:$rootScope.name,password:$scope.password}}).success(function(e){var r,s;return e.error?($scope.disableInputs=!1,r=e.error,s=e.message,"NAME"===r&&"请输入用户名"===s?$scope.register.name.$setValidity("required",!1):"NAME"===r&&"该用户名已存在，请选择其他用户名"===s?$scope.register.name.$setValidity("notTaken",!1):"PASSWORD"===r&&"请输入6位密码"===s?$scope.register.password.$setValdity("minlength",!1):alert(s)):(tele.run("userManager.load",e).then(function(){return tele.run("userManager.checkin").then(function(){return pageUtils.redirectUrl("options.html#/domains")})}),tele.run("track.pv","/chrome-extension/register/success"),$rootScope.isVirgin&&tele.run("track.event",LOGIN_EVENT_NAME,"register-success"),storage.set("afterRegister",!0))}).error(function(){return alert($scope.betweenCertInterval()?ERROR_LOGIN_UNKNOWN:ERROR_LOGIN_TIME),$scope.disableInputs=!1});for(s=!1,i=["password","password2"],t=0,n=i.length;n>t;t++)r=i[t],e=$scope.register[r],e.$stateVisible=!0,e.$invalid&&!s&&($scope.focuses[r]=!0,s=!0)}}):$rootScope.goToAccountView()}},define(e,r)}).call(this);